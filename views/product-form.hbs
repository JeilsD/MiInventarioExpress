<h3>{{title}}</h3>

{{! --- Bloque para mostrar errores de validación (Tarea 8) --- }}
{{#if errors}}
<div style="color: red; border: 1px solid red; padding: 10px; margin-bottom: 15px;">
    <strong>Por favor corrige los siguientes errores:</strong>
    <ul>
        {{#each errors}}
        <li>{{this.msg}}</li>
        {{/each}}
    </ul>
</div>
{{/if}}

{{! 
  - IMPORTANTE: enctype="multipart/form-data" es OBLIGATORIO 
  - para que la carga de archivos (Multer) funcione. (Tarea 6)
}}

{{! --- MODIFICADO: El 'action' cambia si estamos editando --- }}
<form 
    action="{{#if isEditing}}/products/{{product._id}}/update{{else}}/products{{/if}}" 
    method="POST" 
    enctype="multipart/form-data"
>

    <div>
        <label for="nombre">Nombre del Producto:</label>
        <input 
            type="text" 
            id="nombre" 
            name="nombre"
            value="{{product.nombre}}" 
        >
    </div>
    <br>
    <div>
        <label for="precio">Precio:</label>
        <input 
            type="number" 
            id="precio" 
            name="precio" 
            step="0.01"
            value="{{product.precio}}"
        >
    </div>
    <br>
    <div>
        <label for="descripcion">Descripción:</label>
        <textarea 
            id="descripcion" 
            name="descripcion"
        >{{product.descripcion}}</textarea>
    </div>
    <br>

    {{! --- MODIFICADO: Muestra la imagen actual si estamos editando --- }}
    <div>
        <label for="imagen">Imagen del Producto:</label>
        <input 
            type="file" 
            id="imagen" 
            name="imagen"
        >
        {{#if isEditing}}
            <p style="font-size: 0.8em; margin: 5px 0 0 0;">
                Dejar vacío para conservar la imagen actual:
                <br>
                <img 
                    src="{{product.imagen}}" 
                    width="100" 
                    alt="Imagen actual" 
                    style="margin-top: 5px; border: 1px solid #ccc; border-radius: 4px;"
                >
            </p>
        {{/if}}
    </div>
    <br>

    {{! --- MODIFICADO: El texto del botón cambia si estamos editando --- }}
    <button type="submit">
        {{#if isEditing}}Actualizar Producto{{else}}Guardar Producto{{/if}}
    </button>
</form>